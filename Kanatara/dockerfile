# 使用 Ubuntu 22.04 作为基础镜像
FROM ubuntu:22.04

# 设置环境变量，避免交互
ENV DEBIAN_FRONTEND=noninteractive
ENV TZ=Asia/Shanghai

# 更新系统并安装基础工具
RUN apt update && apt install -y curl git build-essential

# 安装 Node.js 20 (通过 NodeSource 官方源)
RUN curl -fsSL https://deb.nodesource.com/setup_20.x | bash - \
  && apt install -y nodejs \
  && npm install -g npm

# 设置工作目录
WORKDIR /app

# 复制项目文件
COPY . .

# 安装依赖
RUN npm install

# 复制环境文件
RUN cp .env.example .env.local || true

# 暴露 Next.js 默认端口
EXPOSE 3000

# 启动开发服务器
CMD ["npm", "run", "dev"]
